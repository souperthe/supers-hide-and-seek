[gd_scene load_steps=42 format=3 uid="uid://c8i5i2af5ohaf"]

[ext_resource type="Script" uid="uid://jrbuo0ken0kb" path="res://assets/scripts/player.gd" id="1_ikdab"]
[ext_resource type="Script" uid="uid://bmoapp8kdmh2f" path="res://assets/scripts/rpc_events.gd" id="2_1qp14"]
[ext_resource type="Script" uid="uid://df1c277cqjm5o" path="res://assets/scripts/controller_manager.gd" id="2_5pvfp"]
[ext_resource type="Script" uid="uid://dt4s1la1cgwgp" path="res://assets/scripts/animation_manager.gd" id="2_7muya"]
[ext_resource type="Script" uid="uid://bxavxns0owjwj" path="res://assets/scripts/voice_emitter.gd" id="2_34ecl"]
[ext_resource type="Script" uid="uid://dmo0jxb8j7daa" path="res://assets/scripts/hitbox_manager.gd" id="2_am6w6"]
[ext_resource type="Script" uid="uid://d1acepvi6enht" path="res://assets/scripts/sound_manager.gd" id="2_fh75e"]
[ext_resource type="Script" uid="uid://2ib7l6uqqdra" path="res://assets/scripts/interaction_manager.gd" id="2_lvyht"]
[ext_resource type="Script" uid="uid://byixfhnxaujvy" path="res://assets/scripts/interaction/rigid_body_3d.gd" id="3_htwuo"]
[ext_resource type="Script" uid="uid://dx63y06pacekr" path="res://assets/scripts/controller_states/hider.gd" id="3_jg13i"]
[ext_resource type="Script" uid="uid://c04b57p8gi1fy" path="res://assets/scripts/controller_actions/hider/idle.gd" id="4_jssbp"]
[ext_resource type="Script" uid="uid://6c5e5ebftq52" path="res://assets/scripts/controller_actions/hider/walk.gd" id="5_6r1sy"]
[ext_resource type="Script" uid="uid://dqcgyyqkxjksd" path="res://assets/scripts/controller_actions/hider/jump.gd" id="6_nqkij"]
[ext_resource type="PackedScene" uid="uid://6g6cls708sff" path="res://assets/objects/player_hud.tscn" id="7_xvjlw"]
[ext_resource type="ArrayMesh" uid="uid://ddlvb5op1kbts" path="res://assets/models/placeholder/player.obj" id="9_bkysh"]
[ext_resource type="Script" uid="uid://qwdcoukg2owl" path="res://assets/scripts/controller_states/big_cheese.gd" id="12_qgtm8"]
[ext_resource type="Texture2D" uid="uid://sfofdqbs0rvf" path="res://assets/images/icons/old-microphone.png" id="13_fg3d2"]
[ext_resource type="Script" uid="uid://c1nptbygdrtmt" path="res://assets/scripts/controller_states/spectate.gd" id="14_axagv"]
[ext_resource type="Script" uid="uid://bu2rt8q5lcw5o" path="res://assets/scripts/controller_actions/big_cheese/idle.gd" id="14_y0ns2"]
[ext_resource type="Script" uid="uid://dhr0dsd005iu7" path="res://assets/scripts/controller_actions/spectate/freecam.gd" id="15_cis3c"]
[ext_resource type="Script" uid="uid://ciqm61qaw8njt" path="res://assets/scripts/controller_actions/big_cheese/walk.gd" id="15_rjy6x"]
[ext_resource type="Script" uid="uid://b78hyq3oq1n0c" path="res://assets/scripts/controller_actions/spectate/specificplayer.gd" id="16_3l5fp"]
[ext_resource type="Script" uid="uid://cscosh8oacq3v" path="res://assets/scripts/controller_actions/big_cheese/fly_transition.gd" id="16_g7bc3"]
[ext_resource type="Script" uid="uid://olq56wixjsls" path="res://assets/scripts/controller_actions/big_cheese/flying.gd" id="17_usqfr"]
[ext_resource type="Script" uid="uid://dtj2tphdin33k" path="res://assets/scripts/controller_actions/big_cheese/flying_land.gd" id="18_vhanp"]
[ext_resource type="Script" uid="uid://b7w14hwl52i2" path="res://assets/scripts/controller_actions/big_cheese/land_fall.gd" id="19_foeld"]
[ext_resource type="Script" uid="uid://icufwxc08tme" path="res://assets/scripts/controller_actions/big_cheese/fall.gd" id="20_7lv6i"]
[ext_resource type="Script" uid="uid://bvofu61bxjlb3" path="res://assets/scripts/controller_actions/big_cheese/attack.gd" id="21_8wh5m"]
[ext_resource type="Script" uid="uid://b8ebovwnw3vl2" path="res://assets/scripts/controller_actions/big_cheese/search.gd" id="26_xmuqx"]
[ext_resource type="Script" uid="uid://bvhsmwc4upntt" path="res://assets/scripts/controller_states/fredbear.gd" id="27_w8ahy"]
[ext_resource type="Script" uid="uid://dvi8yyaqx2t4r" path="res://assets/scripts/controller_actions/fredbear/idle.gd" id="28_cjdy6"]
[ext_resource type="Script" uid="uid://bjk5miuq51i8m" path="res://assets/scripts/controller_actions/fredbear/move.gd" id="29_0hcfg"]
[ext_resource type="Script" uid="uid://db3obgc1pnh5a" path="res://assets/scripts/controller_actions/fredbear/jump.gd" id="30_0hcfg"]
[ext_resource type="Script" uid="uid://c8mdawwvu1sjt" path="res://assets/scripts/controller_actions/fredbear/climbing.gd" id="31_ec4pp"]
[ext_resource type="Script" path="res://assets/scripts/controller_actions/fredbear/punch.gd" id="32_dx6kc"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ikdab"]
radius = 0.3

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_5pvfp"]
radius = 0.3
height = 1.2

[sub_resource type="SceneReplicationConfig" id="SceneReplicationConfig_fg3d2"]
properties/0/path = NodePath(".:position")
properties/0/spawn = true
properties/0/replication_mode = 1
properties/1/path = NodePath(".:rotation")
properties/1/spawn = true
properties/1/replication_mode = 1

[sub_resource type="SphereShape3D" id="SphereShape3D_8wh5m"]
radius = 1.3088431

[sub_resource type="CylinderShape3D" id="CylinderShape3D_am6w6"]
height = 1.4736328
radius = 1.4516602

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_lnwx1"]
radius = 0.8798828
height = 3.6064453

[node name="Player" type="CharacterBody3D" node_paths=PackedStringArray("camera", "cameraArm", "controller", "sound", "interactor", "events", "animator", "hitbox", "voiceEmitter", "playerHud", "abilityTimer", "abilityCooldown", "synchronizer", "_neck", "viewmodelRoot", "modelRoot", "modelPivot", "wallRay", "neckOffset", "collisionStanding", "collisionCrouching", "interactRay")]
script = ExtResource("1_ikdab")
camera = NodePath("neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D")
cameraArm = NodePath("neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm")
controller = NodePath("controllerManager")
sound = NodePath("soundManager")
interactor = NodePath("interactionManager")
events = NodePath("RPCEvents")
animator = NodePath("animationManager")
hitbox = NodePath("hitboxManager")
voiceEmitter = NodePath("VoiceEmitter")
playerHud = NodePath("playerHud")
abilityTimer = NodePath("AbilityTimer")
abilityCooldown = NodePath("AbilityCoolDown")
synchronizer = NodePath("MultiplayerSynchronizer")
_neck = NodePath("neckOffset/Neck")
viewmodelRoot = NodePath("neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D/viewmodelHolder")
modelRoot = NodePath("modelPivot/modelHolder")
modelPivot = NodePath("modelPivot")
wallRay = NodePath("modelPivot/wallRay")
neckOffset = NodePath("neckOffset")
collisionStanding = NodePath("standingCollision")
collisionCrouching = NodePath("crouchingCollision")
interactRay = NodePath("neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D/InteractRay")

[node name="Voice" type="AudioStreamPlayer3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.6314194, 0)
volume_db = 50.0
max_distance = 15.0
bus = &"Voice"
attenuation_filter_db = 0.0

[node name="hitboxManager" type="Node" parent="." node_paths=PackedStringArray("_hitboxHolder", "_corePlayer")]
script = ExtResource("2_am6w6")
_hitboxHolder = NodePath("../modelPivot/HitBoxes")
_corePlayer = NodePath("..")

[node name="animationManager" type="Node" parent="." node_paths=PackedStringArray("_corePlayer")]
script = ExtResource("2_7muya")
_corePlayer = NodePath("..")

[node name="RPCEvents" type="Node" parent="." node_paths=PackedStringArray("_light", "_corePlayer", "_voiceEmitter")]
script = ExtResource("2_1qp14")
_light = NodePath("../neckOffset/Neck/network_light")
_corePlayer = NodePath("..")
_voiceEmitter = NodePath("../Voice")

[node name="VoiceEmitter" type="Node" parent="." node_paths=PackedStringArray("targetEmitter", "targetPlayer", "_talkingSprite")]
script = ExtResource("2_34ecl")
targetEmitter = NodePath("../Voice")
targetPlayer = NodePath("..")
_talkingSprite = NodePath("../Talking")
metadata/_custom_type_script = "uid://bxavxns0owjwj"

[node name="interactionManager" type="Node" parent="." node_paths=PackedStringArray("_corePlayer")]
script = ExtResource("2_lvyht")
_corePlayer = NodePath("..")

[node name="RigidBody3D" type="Node" parent="interactionManager" node_paths=PackedStringArray("_holdPoint")]
script = ExtResource("3_htwuo")
_holdPoint = NodePath("../../neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D/viewmodelHolder/holdPoint")

[node name="soundManager" type="Node" parent="." node_paths=PackedStringArray("_corePlayer")]
script = ExtResource("2_fh75e")
_corePlayer = NodePath("..")

[node name="controllerManager" type="Node" parent="." node_paths=PackedStringArray("corePlayer")]
script = ExtResource("2_5pvfp")
corePlayer = NodePath("..")

[node name="hider" type="Node" parent="controllerManager" node_paths=PackedStringArray("_tiltPivot", "_light")]
script = ExtResource("3_jg13i")
_tiltPivot = NodePath("../../neckOffset/Neck/viewbobPivot/tiltPivot")
_light = NodePath("../../neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D/viewmodelHolder/flashlight")
_initalAction = "idle"

[node name="idle" type="Node" parent="controllerManager/hider"]
script = ExtResource("4_jssbp")

[node name="walk" type="Node" parent="controllerManager/hider"]
script = ExtResource("5_6r1sy")

[node name="jump" type="Node" parent="controllerManager/hider"]
script = ExtResource("6_nqkij")

[node name="spectate" type="Node" parent="controllerManager"]
script = ExtResource("14_axagv")
_initalAction = "specificplayer"

[node name="freecam" type="Node" parent="controllerManager/spectate"]
script = ExtResource("15_cis3c")

[node name="specificplayer" type="Node" parent="controllerManager/spectate"]
script = ExtResource("16_3l5fp")

[node name="big_cheese" type="Node" parent="controllerManager"]
script = ExtResource("12_qgtm8")
_initalAction = "idle"

[node name="idle" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("14_y0ns2")

[node name="walk" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("15_rjy6x")

[node name="fly_transition" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("16_g7bc3")

[node name="flying" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("17_usqfr")

[node name="flying_land" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("18_vhanp")

[node name="land_fall" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("19_foeld")

[node name="fall" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("20_7lv6i")

[node name="attack" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("21_8wh5m")

[node name="search" type="Node" parent="controllerManager/big_cheese"]
script = ExtResource("26_xmuqx")

[node name="red_man" type="Node" parent="controllerManager" node_paths=PackedStringArray("_tiltPivot", "_light")]
script = ExtResource("3_jg13i")
_tiltPivot = NodePath("../../neckOffset/Neck/viewbobPivot/tiltPivot")
_light = NodePath("../../neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D/viewmodelHolder/flashlight")
_initalAction = "idle"

[node name="idle" type="Node" parent="controllerManager/red_man"]
script = ExtResource("4_jssbp")

[node name="walk" type="Node" parent="controllerManager/red_man"]
script = ExtResource("5_6r1sy")

[node name="jump" type="Node" parent="controllerManager/red_man"]
script = ExtResource("6_nqkij")

[node name="fredbear" type="Node" parent="controllerManager"]
script = ExtResource("27_w8ahy")
_initalAction = "idle"

[node name="idle" type="Node" parent="controllerManager/fredbear"]
script = ExtResource("28_cjdy6")

[node name="move" type="Node" parent="controllerManager/fredbear"]
script = ExtResource("29_0hcfg")

[node name="jump" type="Node" parent="controllerManager/fredbear"]
script = ExtResource("30_0hcfg")

[node name="climbing" type="Node" parent="controllerManager/fredbear"]
script = ExtResource("31_ec4pp")

[node name="punch" type="Node" parent="controllerManager/fredbear"]
script = ExtResource("32_dx6kc")

[node name="standingCollision" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_ikdab")
debug_color = Color(0, 0.6, 0.69803923, 1)

[node name="crouchingCollision" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.4, 0)
shape = SubResource("CapsuleShape3D_5pvfp")
debug_color = Color(0, 0.6, 0.69803923, 1)

[node name="neckOffset" type="Node3D" parent="."]

[node name="Neck" type="Node3D" parent="neckOffset"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.7, 0)

[node name="viewbobPivot" type="Node3D" parent="neckOffset/Neck"]

[node name="tiltPivot" type="Node3D" parent="neckOffset/Neck/viewbobPivot"]

[node name="cameraArm" type="SpringArm3D" parent="neckOffset/Neck/viewbobPivot/tiltPivot"]
collision_mask = 2
spring_length = 0.0

[node name="Camera3D" type="Camera3D" parent="neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm"]
fov = 100.0

[node name="viewmodelHolder" type="Node3D" parent="neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.7, 0)
top_level = true

[node name="flashlight" type="SpotLight3D" parent="neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D/viewmodelHolder"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.22825933)
visible = false
light_energy = 2.0
shadow_enabled = true
spot_range = 15.244
spot_angle = 43.15

[node name="holdPoint" type="Node3D" parent="neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D/viewmodelHolder"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.71499515, -1.3728298)
visible = false

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D"]
remote_path = NodePath("../viewmodelHolder")
update_rotation = false
update_scale = false

[node name="InteractRay" type="RayCast3D" parent="neckOffset/Neck/viewbobPivot/tiltPivot/cameraArm/Camera3D"]
target_position = Vector3(0, 0, -3)

[node name="network_light" type="SpotLight3D" parent="neckOffset/Neck"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.22825933)
visible = false
light_energy = 2.0
shadow_enabled = true
spot_range = 15.244
spot_angle = 43.15

[node name="playerHud" parent="." node_paths=PackedStringArray("_corePlayer") instance=ExtResource("7_xvjlw")]
_corePlayer = NodePath("..")

[node name="Node3D" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.7940472, 0)

[node name="Talking" type="Sprite3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.36858, 0)
visible = false
pixel_size = 0.001
billboard = 1
texture = ExtResource("13_fg3d2")

[node name="MultiplayerSynchronizer" type="MultiplayerSynchronizer" parent="."]
replication_config = SubResource("SceneReplicationConfig_fg3d2")
visibility_update_mode = 1
public_visibility = false

[node name="modelPivot" type="Node3D" parent="."]

[node name="modelHolder" type="Node3D" parent="modelPivot"]

[node name="Player" type="MeshInstance3D" parent="modelPivot/modelHolder"]
transform = Transform3D(-0.027, 0, -2.360415e-09, 0, 0.027, 0, 2.360415e-09, 0, -0.027, 0, 0, 0)
mesh = ExtResource("9_bkysh")
skeleton = NodePath("../../..")

[node name="HitBoxes" type="Node3D" parent="modelPivot"]

[node name="cheesebox" type="Area3D" parent="modelPivot/HitBoxes"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="modelPivot/HitBoxes/cheesebox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5268917, -2.4641435)
shape = SubResource("SphereShape3D_8wh5m")

[node name="cheesebox_fall" type="Area3D" parent="modelPivot/HitBoxes"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="modelPivot/HitBoxes/cheesebox_fall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.06591797, 0)
shape = SubResource("CylinderShape3D_am6w6")

[node name="bearbox" type="Area3D" parent="modelPivot/HitBoxes"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="modelPivot/HitBoxes/bearbox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.0156612, -1.2079715)
shape = SubResource("CapsuleShape3D_lnwx1")

[node name="wallRay" type="RayCast3D" parent="modelPivot"]
target_position = Vector3(0, 0, -1)
collision_mask = 2

[node name="AbilityCoolDown" type="Timer" parent="."]
wait_time = 20.0
one_shot = true

[node name="AbilityTimer" type="Timer" parent="."]
wait_time = 8.0
one_shot = true
